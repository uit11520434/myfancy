/*
 *
 *  jQuery $.getImageData Plugin 0.2
 *  http://www.maxnov.com/getimagedata
 *  
 *  Written by Max Novakovic (http://www.maxnov.com/)
 *  Date: Mon Sep 13 2010
 *
 * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
 *  
 *  Includes jQuery JSONP Core Plugin 2.1.2
 *  http://code.google.com/p/jquery-jsonp/
 *  Copyright 2010, Julian Aubourg
 *  Released under the MIT License.
 * 
 * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * *
 *  
 *  Copyright 2010, Max Novakovic
 *  Dual licensed under the MIT or GPL Version 2 licenses.
 *  http://www.maxnov.com/getimagedata/#license
 * 
 */
(function(c,g){function k(){}function h(a){s=[a]}function e(a,l,m){return a&&a.apply(l.context||l,m)}function i(a){function l(b){!n++&&g(function(){p();q&&(t[d]={s:[b]});z&&(b=z.apply(a,[b]));e(a.success,a,[b,A]);e(B,a,[a,A])},0)}function m(b){!n++&&g(function(){p();q&&b!=C&&(t[d]=b);e(a.error,a,[a,b]);e(B,a,[a,b])},0)}a=c.extend({},D,a);var B=a.complete,z=a.dataFilter,E=a.callbackParameter,F=a.callback,R=a.cache,q=a.pageCache,G=a.charset,d=a.url,f=a.data,H=a.timeout,r,n=0,p=k;a.abort=function(){!n++&& p()};if(e(a.beforeSend,a,[a])===false||n)return a;d=d||u;f=f?typeof f=="string"?f:c.param(f,a.traditional):u;d+=f?(/\?/.test(d)?"&":"?")+f:u;E&&(d+=(/\?/.test(d)?"&":"?")+escape(E)+"=?");!R&&!q&&(d+=(/\?/.test(d)?"&":"?")+"_"+(new Date).getTime()+"=");d=d.replace(/=\?(&|$)/,"="+F+"$1");q&&(r=t[d])?r.s?l(r.s[0]):m(r):g(function(b,o,v){if(!n){v=H>0&&g(function(){m(C)},H);p=function(){v&&clearTimeout(v);b[I]=b[w]=b[J]=b[x]=null;j[K](b);o&&j[K](o)};window[F]=h;b=c(L)[0];b.id=M+S++;if(G)b[T]=G;var O=function(y){(b[w]|| k)();y=s;s=undefined;y?l(y[0]):m(N)};if(P.msie){b.event=w;b.htmlFor=b.id;b[I]=function(){b.readyState=="loaded"&&O()}}else{b[x]=b[J]=O;P.opera?(o=c(L)[0]).text="jQuery('#"+b.id+"')[0]."+x+"()":b[Q]=Q}b.src=d;j.insertBefore(b,j.firstChild);o&&j.insertBefore(o,j.firstChild)}},0);return a}var Q="async",T="charset",u="",N="error",M="_jqjsp",w="onclick",x="on"+N,J="onload",I="onreadystatechange",K="removeChild",L="<script/>",A="success",C="timeout",P=c.browser,j=c("head")[0]||document.documentElement, t={},S=0,s,D={callback:M,url:location.href};i.setup=function(a){c.extend(D,a)};c.jsonp=i})(jQuery,setTimeout); jQuery.getImageData=function(c){var g=/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/;if(c.url){var k=location.protocol==="https:",h="";if(c.server&&g.test(c.server)&&c.server.indexOf("https:")&&(k||c.url.indexOf("https:")))h=c.server;else{h=!c.url.indexOf("https:")||k?"https://img-to-json.appspot":"http://img-to-json.maxnov";h+=".com/?callback=?"}$.jsonp({url:h,data:{url:escape(c.url)},dataType:"jsonp",timeout:1E4,success:function(e){var i=new Image;$(i).load(function(){this.width= e.width;this.height=e.height;typeof c.success==typeof Function&&c.success(this)}).attr("src",e.data)},error:function(e,i){typeof c.error==typeof Function&&c.error(e,i)}})}else typeof c.error==typeof Function&&c.error(null,"no_url")};
