var ScrollToTop=ScrollToTop||{id:"ScrollToTop",control:$("#"+this.id),setup:function(){var a="<a id='"+ScrollToTop.id+"' href='#' class='Button WhiteButton Offscreen Indicator'><strong>Scroll to Top</strong><span></span></a>";$("body").append(a);var c=$(window).height()/2;$(window).scroll(function(){(window.innerWidth?window.pageYOffset:document.documentElement.scrollTop)>=c?$("#ScrollToTop").removeClass("Offscreen"):$("#ScrollToTop").addClass("Offscreen")});$("#ScrollToTop").click(function(){$("html, body").animate({scrollTop:"0px"},
400);return false})}},Modal=Modal||{setup:function(){$(document).keydown(function(a){if(a.keyCode==27){var c=$(".ModalContainer:visible").attr("id");if(c)Modal.close(c);else $("#zoomScroll").length&&window.history.back();a.preventDefault()}})},show:function(a){var c=$("#"+a);a=$(".modal:first",c);$("body").addClass("noscroll");c.show();var d=a.outerHeight();a.css("margin-bottom","-"+d/2+"px");setTimeout(function(){c.addClass("visible");c.css("-webkit-transform","none")},1);return false},close:function(a){var c=
$("#"+a);$("#zoomScroll").length===0&&$("body").removeClass("noscroll");c.removeClass("visible");setTimeout(function(){c.hide();c.css("-webkit-transform","translateZ(0)")},251);return false}};
$(document).ready(function(){ScrollToTop.setup();Modal.setup();$(".tipsyHover").tipsy({gravity:"n",delayIn:0.1,delayOut:0.1,opacity:0.7,live:true,html:true});$("#query").focus(function(){cache&&$(this).catcomplete("search",$(this).val())});$.widget("custom.catcomplete",$.ui.autocomplete,{_renderMenu:function(c,d){var f=this,g="";$.each(d,function(b,e){if(e.category!=g){c.append("<li class='ui-autocomplete-category'>"+e.category+"</li>");g=e.category}f._renderItem(c,e)});d={link:"/search/?q="+this.term};
$("<li></li>").data("item.autocomplete",d).append("<a href='/search/?q="+this.term+"' class='ui-corner-all' tabindex='-1' style='font-weight:bold; min-height:0 !important;'>Search for "+this.term+"</a>").appendTo(c)}});

var a=$("#query").catcomplete({source:function(c,d){Tagging.getFriends(c,function(f){var g=f;if(myboards){g=tagmate.filter_options(myboards,c.term);g=f.concat(g)}for(f=0;f<g.length;f++)g[f].value=g[f].label;d(g)})},minLength:1,delay:0,appendTo:"#SearchAutocompleteHolder",select:function(c,
d){document.location.href=d.item.link}});

if(typeof a.data("catcomplete")!="undefined")a.data("catcomplete")._renderItem=function(c,d){var f="<a href='"+d.link+"'><img src='"+d.image+"' class='AutocompletePhoto' alt='Photo of "+d.label+"' width='38px' height='38px'/><span class='AutocompleteName'>"+d.label+"</span></a>";return $("<li></li>").data("item.autocomplete",d).append(f).appendTo(c)};$("#query").defaultValue("Search","default_value");$("#Search #query_button").click(function(){$("#Search form").submit();
return false});$("body").on("click","a[rel=nofollow]",function(c){var d=$(this).attr("href");if(d==="#")return c.isDefaultPrevented();if(!d.match(/^(http|https):\/\//)||d.match(/(http:\/\/|https:\/\/|\.)pinterest\.com/gi)||$(this).hasClass("safelink"))return true;c=(c=$(this).parents(".pin").attr("data-id")||$(this).parents(".pin").attr("pin-id")||$(this).attr("data-id"))?"&pin="+c:"";var f=$(this).parents(".comment").attr("comment-id");f=f?"&comment_id="+f:"";window.open("/offsite/?url="+encodeURIComponent(d)+
"&token="+getCookie("csrftoken")+c+f);return false})});